/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/torch/utils/data/dataloader.py:683: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, then device pinned memory won't be used.
  warnings.warn(warn_msg)
Traceback (most recent call last):
  File "/Users/gclinger/Documents/projects/Multi-Stream-Neural-Networks/test_sunrgbd_complete.py", line 346, in <module>
    stats = monitor.analyze_streams(
            ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'StreamMonitor' object has no attribute 'analyze_streams'
================================================================================
SUN RGB-D 15-Category Dataset & Training Pipeline Test
================================================================================

[Test 1] Dataset Loading
--------------------------------------------------------------------------------
Loaded SUN RGB-D train set: 8041 samples, 15 classes
Loaded SUN RGB-D val set: 2018 samples, 15 classes
✓ Train dataset loaded: 8041 samples
✓ Val dataset loaded: 2018 samples
✓ Sample counts correct

[Test 2] Sample Access and Shape Verification
--------------------------------------------------------------------------------
Train sample 0:
  RGB shape: torch.Size([3, 224, 224]) (expected: [3, 224, 224])
  Depth shape: torch.Size([1, 224, 224]) (expected: [1, 224, 224])
  Label: 13 (rest_space)
✓ Train sample shapes correct

Val sample 0:
  RGB shape: torch.Size([3, 224, 224])
  Depth shape: torch.Size([1, 224, 224])
  Label: 13 (rest_space)
✓ Val sample shapes correct

[Test 3] Class Distribution Verification
--------------------------------------------------------------------------------
Train distribution (top 5):
  rest_space          : 1354 (16.84%)
  office              :  989 (12.30%)
  classroom           :  959 (11.93%)
  bedroom             :  872 (10.84%)
  furniture_store     :  800 ( 9.95%)

Val distribution (top 5):
  rest_space          :  339 (16.80%)
  office              :  248 (12.29%)
  classroom           :  240 (11.89%)
  bedroom             :  218 (10.80%)
  furniture_store     :  201 ( 9.96%)
✓ All 15 classes present in both splits
✓ Class imbalance: 8.5x (should be <10x)

[Test 4] DataLoader Creation
--------------------------------------------------------------------------------
Loaded SUN RGB-D train set: 8041 samples, 15 classes
Loaded SUN RGB-D val set: 2018 samples, 15 classes

DataLoader Info:
  Train batches: 503
  Val batches: 127
  Batch size: 16
✓ Train loader: 503 batches
✓ Val loader: 127 batches
✓ Batch counts correct

[Test 5] Batch Iteration and Shape Verification
--------------------------------------------------------------------------------
Train batch shapes:
  RGB: torch.Size([16, 3, 224, 224]) (expected: [16, 3, 224, 224])
  Depth: torch.Size([16, 1, 224, 224]) (expected: [16, 1, 224, 224])
  Labels: torch.Size([16]) (expected: [16])
✓ Batch shapes correct
✓ Labels in range [0, 14]: min=0, max=13
✓ Val batch shapes correct

[Test 6] Model Creation
--------------------------------------------------------------------------------
Device: cpu
✓ Model created successfully
  Total parameters: 22,362,127
  Trainable parameters: 22,362,127

[Test 7] Forward Pass
--------------------------------------------------------------------------------
Output shape: torch.Size([16, 15]) (expected: [16, 15])
Output range: [-2.3247, 2.6400]
Predictions: [8 8 8 8 8]
True labels: [12 13  1  9  6]
✓ Forward pass successful

[Test 8] Loss Computation
--------------------------------------------------------------------------------
Loss value: 3.3010
✓ Loss computation successful

[Test 9] Backward Pass and Gradient Check
--------------------------------------------------------------------------------
Parameters with gradients: 122/122
✓ Backward pass successful
✓ Optimizer step successful

[Test 10] Stream-Specific Optimization
--------------------------------------------------------------------------------
Stream1 (RGB) parameters: 60
Stream2 (Depth) parameters: 60
Other parameters: 2
✓ Stream-specific optimizer created
  Stream1 LR: 0.001000
  Stream2 LR: 0.001500
  Other LR: 0.001000

[Test 11] Stream Monitoring
--------------------------------------------------------------------------------
✗ Stream monitoring failed: 'StreamMonitor' object has no attribute 'analyze_streams'
